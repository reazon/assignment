##<!-- $Header: /cvs/sakai2/legacy/tools/src/webapp/vm/assignment/chef_assignments_student_view_grade.vm,v 1.2 2005/05/19 19:39:49 gsilver.umich.edu Exp $ -->
<style type="text/css">
	.toggleAnchor{
		border:1px solid #cef;
		background:#cef url(/library/image/sakai/expand.gif) 5px no-repeat !important;
		padding:5px 5px 5px 25px !important;
		cursor:pointer
	}
	.toggleAnchor:hover,	.toggleAnchorOpen:hover{
		border:1px solid #9cf;
	}

	.toggleAnchorOpen{
		border:1px solid #cef;
		background:#cef url(/library/image/sakai/collapse.gif) 5px no-repeat !important;
		padding:5px 5px 5px 25px !important;
		cursor:pointer
	}
	.toggledContent{
		margin:0;
		border:2px solid #cef;
		border-top:none;
		padding: 1em
	}
	.toggledContent h4{
		color:#000 !important;
		width:40em;
		margin:.5em 0 !important;
		padding:.3em 0;
		border-bottom:2px solid #ccc
	}

</style>

<script type="text/javascript" src="/library/js/jquery.js"></script>
<script type="text/javascript">
 $(document).ready(function(){
 	// toggle a fade
 	jQuery.fn.fadeToggle = function(speed, easing, callback) {
   return this.animate({opacity: 'toggle'}, speed, easing, callback);
}; 
$('.model').hide();
$('.notes').hide();
$('.allPurpose').hide();
$('#toggleModel').click(function(){
	$('.model').fadeToggle();
	if ($('#toggleModel').is('.toggleAnchor')){
		$('#toggleModel').removeClass('toggleAnchor')
		$('#toggleModel').addClass('toggleAnchorOpen')
		}
	else {
		$('#toggleModel').removeClass('toggleAnchorOpen')
			$('#toggleModel').addClass('toggleAnchor')
	}	

  resizeFrame('grow');
	return false;
});

$('#toggleNotes').click(function(){
	$('.notes').fadeToggle();
	if ($('#toggleNotes').is('.toggleAnchor')){
		$('#toggleNotes').removeClass('toggleAnchor')
		$('#toggleNotes').addClass('toggleAnchorOpen')
		}
	else {
		$('#toggleNotes').removeClass('toggleAnchorOpen')
			$('#toggleNotes').addClass('toggleAnchor')
	}	

  resizeFrame('grow');
	return false;
});

$('#toggleAllPurpose').click(function(){
	$('.allPurpose').fadeToggle();
	if ($('#toggleAllPurpose').is('.toggleAnchor')){
		$('#toggleAllPurpose').removeClass('toggleAnchor')
		$('#toggleAllPurpose').addClass('toggleAnchorOpen')
		}
	else {
		$('#toggleAllPurpose').removeClass('toggleAnchorOpen')
			$('#toggleAllPurpose').addClass('toggleAnchor')
	}	

  resizeFrame('grow');
	return false;
});


});
//this function needs jquery 1.1.2 or later - it resizes the parent iframe without bringing the scroll to the top
	function resizeFrame(updown) 
	{
		if (top.location != self.location) 	 {
			var frame = parent.document.getElementById(window.name);
		}	
			if( frame ) 
		{
			if(updown=='shrink')
			{
				var clientH = document.body.clientHeight - 30;
			}
			else
			{
				var clientH = document.body.clientHeight + 30;
			}
			$( frame ).height( clientH );
		} 
		else 
		{
			throw( "resizeFrame did not get the frame (using name=" + window.name + ")" );
		}
	}

</script>
<div class="portletBody" xmlns:wairole="http://www.w3.org/2005/01/wai-rdf/GUIRoleTaxonomy#"  xmlns:aaa="http://www.w3.org/2005/07/aaa">
	#set ($assignment = $submission.Assignment)
	#if ($taggable)
		#if (!$itemHelpers.isEmpty())
		<ul class="navIntraTool actionToolBar" role="menu">
				#set ($first = true)
				#foreach ($helperInfo in $itemHelpers)
					#if (!$first)
						<li  class="firstToolBarItem" role="menuitem">
							<span><a href="#toolLinkParam("$action" "doHelp_item" "itemRef=$validator.escapeUrl($item.reference)&providerId=$validator.escapeUrl($helperInfo.provider.id)")" title="$!helperInfo.description">$!helperInfo.name</a></span>
						</li>	
					#else
						#set ($first = false)
						<li role="menuitem">	
						<span><a href="#toolLinkParam("$action" "doHelp_item" "itemRef=$validator.escapeUrl($item.reference)&providerId=$validator.escapeUrl($helperInfo.provider.id)")" title="$!helperInfo.description">$!helperInfo.name</a></span>
					#end
				#end
			</ul>
		#end
	#end
	<h3>
	$validator.escapeHtml($assignment.getTitle())
			#if ($submission.Returned)
						<span class="highlight"> - $tlang.getString("gen.returned")</span>
			#elseif (!$!nonElectronicType)
				<span class="highlight"> - $tlang.getString("gen.subm4")</span>
			#end
		</h3>

		#if ($alertMessage)<div class="alertMessage">$tlang.getString("gen.alert") $validator.escapeHtml($alertMessage)</div>#end
		#set($submitTime=false)
		#set($submitTime=$submission.getTimeSubmitted())
		#set($returnTime=false)
		#set($returnTime=$submission.getTimeReturned())
			<table class="itemSummary" summary="$tlang.getString("stuviewgrad.thegradet")">
				<tr>
					<th>
						$tlang.getString("gen.tit2")
					</th>
					<td valign="top">
						$validator.escapeHtml($assignment.title)
					</td>
				</tr>
				<tr>
					<th>
						$tlang.getString("gen.student")
				 </th>
					<td>
						#set ($submitters = $submission.submitters)
						#foreach ($submitter in $submitters)
							$submitter.DisplayName<br />
						#end
					</td>
				</tr>
				#if ($!submissionType != 4)
					## exclude non-electronic type of submission
					<tr>
						<th>
							$tlang.getString("gen.subm5") 
						</th>
						<td>
							## get submit time
							#if($!submitTime)$submitTime.toStringLocalFull()#end<br />
						</td>
					</tr>
				#end
				<tr>
					<th>
						$tlang.getString("gen.gra2") 
					</th>
					<td>
					#if ($submission.Graded && ($submission.GradeReleased || $submission.Returned))
						##show grade when release or returned
						#if ($assignment.getContent().TypeOfGrade != 1)
							$submission.GradeDisplay
						#else
							$tlang.getString("gen.nograd")
						#end
					#else
						#if ($submission.Returned)
							#if ($!returnTime && $!submitTime && $returnTime.after($submitTime))
								$tlang.getString("gen.returned") $returnTime.toStringLocalFull()
								#if ($submission.Graded)	
									, $submission.GradeDisplay
								#end
							#elseif ($!submitTime)
								$tlang.getString("gen.resub") $submitTime.toStringLocalFull()
								#if ($submitTime.after($assignment.DueTime))
									<span class="highlight"> $tlang.getString("gen.late")</span>
								#end
							#end
						#else
							$tlang.getString("ungra")
						#end
					#end
					#set ($gradeScale = $assignment.getContent().getTypeOfGradeString($assignment.getContent().getTypeOfGrade()))
					#if ($gradeScale == "Points")
						(max $assignment.getContent().getMaxGradePointDisplay())
					#end
				</td>
				</tr>
				#if($allowReviewService && $assignment.getContent().AllowReviewService && $assignment.getContent().AllowStudentViewReport)
					<tr>
						<th>
							$tlang.getString("review.report")
						</th>
							<td>
							#if ($submission.getReviewReport().equals("Error"))
								$tlang.getString("review.notavail")
							#else
								<img src="$submission.getReviewIconUrl()" alt="$submission.getReviewScore()">
							
								<a href="$submission.getReviewReport()" target="_blank">$tlang.getString("review.viewreport")</a>
							#end
							</td>
				
					</tr>
				#end
			
			</table>
		#if($assignment.getContent().AllowReviewService && $assignment.getContent().AllowStudentViewReport)
			<div id="report" style='display:none'>$submission.getReviewReport()</div>
		#end
		<h4>
			$tlang.getString("gen.instr")
		</h4>				
							
		#if ($!assignment.getContent().getInstructions().length()>0)
			<div class="textPanel">$validator.escapeHtmlFormattedText($!assignment.getContent().getInstructions())</div>
		#else
		#end
			## model answer
			#if($allowViewModelAnswer)
			<h4  id="toggleModel" class="toggleAnchor specialLink">$tlang.getString('modelAnswer')</h4>
			<div class="model toggledContent">
					<p>$!assignmentModelAnswerItem.getText()</p>
					#set ($mAttachments = $!assignmentModelAnswerItem.getAttachmentObjectSet())
						<ul class="attachList">
							#set ($size = 0)
							#set ($props = false)
							#foreach ($attachment in $!mAttachments) 
								#set ($props = $attachment.Properties) 
								#if ($!props)
									#set ($size = $size + 1)
								#end
							#end
							#if ($size == 0)
								<p class="instruction">$tlang.getString("gen.noatt")</p>
							#else
								#foreach ($attachment in $mAttachments)
									#set ($props = false)
									#set ($props = $attachment.Properties) 
									#if ($!props)
									<li>
										#if ($props.getBooleanProperty($props.NamePropIsCollection))
											<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="$tlang.getString("gen.folatt")" />
										#else
											<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="$tlang.getString("gen.filatt")" />
										#end
										<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
										#if (!$props.getBooleanProperty($props.NamePropIsCollection))
											($props.getPropertyFormatted($props.NamePropContentLength))
										#end
									</li>
									#end
							#end
					#end
					</ul>
				</div>
			#end
			#if ($!allowReadAssignmentNoteItem)
				<h4  id="toggleNotes" class="toggleAnchor specialLink">$tlang.getString('note.label')</h4>
				<div class="notes toggledContent">
					$!assignmentNoteItem.getNote()
				</div>
			#end
			##all purpose
			#if ($!allowViewAllPurposeItem)
			<h4  id="toggleAllPurpose" class="toggleAnchor specialLink">$tlang.getString('allPurpose')</h4>
			<div class="allPurpose toggledContent">
					<p>$!assignmentAllPurposeItem.getTitle()</p>
					<p>$!assignmentAllPurposeItem.getText()</p>
					#set ($aAttachments = $!assignmentAllPurposeItem.getAttachmentObjectSet())
						<ul class="attachList">
							#set ($size = 0)
							#set ($props = false)
							#foreach ($attachment in $!aAttachments) 
								#set ($props = $attachment.Properties) 
								#if ($!props)
									#set ($size = $size + 1)
								#end
							#end
							#if ($size == 0)
								<p class="instruction">$tlang.getString("gen.noatt")</p>
							#else
								#foreach ($attachment in $aAttachments)
									#set ($props = false)
									#set ($props = $attachment.Properties) 
									#if ($!props)
									<li>
										#if ($props.getBooleanProperty($props.NamePropIsCollection))
											<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="$tlang.getString("gen.folatt")" />
										#else
											<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="$tlang.getString("gen.filatt")" />
										#end
										<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
										#if (!$props.getBooleanProperty($props.NamePropIsCollection))
											($props.getPropertyFormatted($props.NamePropContentLength))
										#end
									</li>
									#end
							#end
					#end
					</ul>
				</div>
			#end
			#if ($taggable)
    	    	#parse ("/vm/assignment/chef_assignments_tags_list.vm")
			#end
			<hr class="itemSeparator" />
			##show instructor feedback if the submission is (1) graded and release or (2) returned
			#if (($submission.Graded && $submission.GradeReleased) || $submission.Returned)
				## show feedback text when submission is released or returned
				#if ($!submission.FeedbackText && ($submission.FeedbackText.length()>0))
					<h5>$tlang.getString("gen.orisub2")</h5>
					<div class="textPanel">$submission.FeedbackFormattedText</div>
				#else
					#set ($text = $submission.getSubmittedText())
					#if ($!text && $text.length() > 0)
						<h4>$tlang.getString("gen.orisub")</h4>
						<div class="textPanel">$submission.getSubmittedText()</div>
					#end
				 #end
			#else
				#set ($text = $submission.getSubmittedText())
				#if ($!text && $text.length() > 0)
					<h4>$tlang.getString("gen.orisub")</h4>
					<div class="textPanel">$submission.getSubmittedText()</div>
				#end
			#end
			#set ($submittedAttachments = $submission.SubmittedAttachments)
			#set ($size = 0)
			#set ($props = false)
			#foreach ($attachment in $submittedAttachments) 
				#set ($props = $attachment.Properties) 
				#if ($!props)
					#set ($size = $size + 1)
				#end
			#end
			#if ($size == 0)
				##$tlang.getString("gen.noatt")
			#else
				<h5>$tlang.getString("gen.stuatt")</h5>
					<ul class="attachList indnt1">
					#foreach ($attachment in $submittedAttachments) 
						#set ($props = false)
						#set ($props = $attachment.Properties) 
						#if ($!props)
							<li>
								#if ($props.getBooleanProperty($props.NamePropIsCollection))
									<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="$tlang.getString("gen.folatt")" />
								#else
									<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="$tlang.getString("gen.filatt")" />
								#end
								<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
								#if (!$props.getBooleanProperty($props.NamePropIsCollection))
									($props.getPropertyFormatted($props.NamePropContentLength))
								#end
							</li>
						#end
					#end
				</ul>
			#end	
			##show instructor comment if the submission is (1) graded and release or (2) returned
			#if (($submission.Graded && $submission.GradeReleased) || $submission.Returned)
				## show feedback comment and feedback comment when submission is released or returned
				#if (($!submission.FeedbackComment) && ($submission.FeedbackComment.length()>0))
					<h5>$tlang.getString("gen.addinst")</h5>	
					<div class="textPanel">$validator.escapeHtmlFormattedText($submission.FeedbackComment)</div>
				#end
				#set ($size = 0)
				#set ($props = false)
				#set ($feedbackAttachments = $submission.FeedbackAttachments)
				#set ($size = 0)
				#set ($props = false)
				#foreach ($attachment in $feedbackAttachments) 
					#set ($props = $attachment.Properties) 
					#if ($!props)
						#set ($size = $size + 1)
					#end
				#end
				#if ($size == 0)
				#else
					<h5>$tlang.getString("gen.addinstatts") </h5>
					<ul class="attachList indnt1">
						#foreach ($attachment in $feedbackAttachments) 
							#set ($props = false)
							#set ($props = $attachment.Properties) 
							#if ($!props)
								<li>
									#if ($props.getBooleanProperty($props.NamePropIsCollection))
										<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="$tlang.getString("gen.folatt")" />
									#else
										<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="$tlang.getString("gen.filatt")" />
									#end
									<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
									#if (!$props.getBooleanProperty($props.NamePropIsCollection))
										($props.getPropertyFormatted($props.NamePropContentLength))
									#end
								</li>
							#end
						#end
					</ul>
				#end
			#end
		<form action="#toolForm("AssignmentAction")" method="post" >
			<div class="act">
				<input type="submit" accesskey="x" name="eventSubmit_doCancel_view_grade" value="$tlang.getString("gen.backtolist")" accesskey="x" class="active"/>
			</div>
		</form>
	</div>
	

							
				
					
	<script type="text/javascript">
		<!--
			function display_item(id) {
				var item = document.getElementById(id);
				if(item.style.display == 'none')
				item.style.display = 'block';
				else
				item.style.display = 'none';
			}
		//-->
	</script>
